# fybatis 概述

fybatis 是一个从零写起的类 MyBatis ORM 框架。用于学习 MyBatis 中优秀的编程思想。

**注意绝对不能商用。不承担任何风险责任。**

# 目录

*  [v1.0.0 版本的思考](#v1.0.0版本的思考)
*  [v1.0.0 的实现方式](#v1.0.0的实现方式)
*  [v1.0.0 的缺点](#v1.0.0的缺点)
*  [v1.1.0 实现过程](#v1.1.0实现过程)
*  [v1.1.0 的优缺点](#v1.1.0的优缺点)

# v1.0.0版本的思考

**通过一个 Mapper 接口，就可以操作数据库从而获取一个实体类。** 我们最简陋的版本就是要实现这样的一个简单的功能。

# v1.0.0的实现方式

不是所有框架一开始都是很优雅的。想怎么来就怎么来。

不用考虑单一职责，不用考虑开闭原则。

就给你一副键盘，一个 IDE，就是撸代码，就是干！

当然我们还是要有一个会话的概念，每一次操作数据库就是一次会话，也就是一个 SqlSession。

可以理解为给数据库管理员打电话：喂，你好，给我来几条数据，条件为 xxx。管理员收到了之后，说：好的，就是这些东西给你，拜拜。我说：谢谢，拜拜（挂电话）。

# v1.0.0的缺点

直接撸代码一般都是垃圾代码的一种生产过程，这里也不例外。

问题点整理：

1. 每有一条新的sql语句执行，就需要自己实现新的 SQL 语句操作 JDBC 的方法。每次都要写，很麻烦。

先考虑这么多吧，新加一个 feature，准备开始做 v1.1.0

# v1.1.0实现过程

其实很简单，在 v1.0.0 的基础上，将 JDBC 部分的代码封装成几个对象。注意这里是多个对象。

如何拆分？其实也很简单，我们都知道 JDBC 操作是有几个过程的。这里可以参考**单一职责原则**，对每一个过程抽象一个对象。

最后我们可以分为四个过程。分别是：
1. 对参数的处理。
2. 对 SQL 语句的参数拼接。
3. 操作数据库。
4. 对返回值的处理。

## 具体细节

其次将数据库参考抽象出一个接口 Executor，再写一个简单处理的实现类 SimpleExecutor。

在 SimpleExecutor 的具体方法中，通过之前拆分的多个对象执行相应的操作。

# v1.1.0的优缺点

**优点**：
1. 实现了动态对返回的实体类实例化和设置属性。
2. 抽象出了 Executor 和不同过程的 Handler，在一定程度做到了“单一职责”。也可以理解为“委托”，Executor 委托 Handler 做事。

**缺点**：
1. 没有解决硬编码的 Mapper 接口实现类。
2. 没有对配置项做统一的处理，目前逻辑都在 Executor 中。其实这部分并不属于 Executor 的功能。

接下来引出 v1.2.0 来解决上述缺点。


